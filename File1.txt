I am happy with this code. This is the code of Feature2 branch.